generalize integration function to be compatible with all kind of integration schemes